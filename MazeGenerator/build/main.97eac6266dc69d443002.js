!function(t){function e(e){for(var n,r,o=e[0],s=e[1],l=e[2],d=0,c=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&c.push(a[r][0]),a[r]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n]);for(u&&u(e);c.length;)c.shift()();return h.push.apply(h,l||[]),i()}function i(){for(var t,e=0;e<h.length;e++){for(var i=h[e],n=!0,o=1;o<i.length;o++){var s=i[o];0!==a[s]&&(n=!1)}n&&(h.splice(e--,1),t=r(r.s=i[0]))}return t}var n={},a={0:0},h=[];function r(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=n,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window.webpackJsonp=window.webpackJsonp||[],s=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=s;h.push([129,1]),i()}({129:function(t,e,i){i(130),t.exports=i(324)},323:function(t,e){},324:function(t,e,i){"use strict";i.r(e);var n=i(1),a=i(64),h=i(126),r=i(127),o=i.n(r);function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var l=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pathWidth=e.pathWidth||10,this.wall=e.wall||2,this.outerWall=e.outerWall||2,this.width=e.width||25,this.height=e.height||25,this.x=this.width/2|0,this.y=this.height/2|0,this.seed=e.seed||"1",this.wallColor=e.wallColor||"#000",this.pathColor=e.pathColor||"#fff",this.seedRand=new o.a(this.seed),this.delay=10,this.timer=null,this.init()}var e,i,n;return e=t,(i=[{key:"init",value:function(){this.offset=this.pathWidth/2+this.outerWall,this.map=[],this.canvas=document.createElement("canvas"),this.canvas.setAttribute("id","maze"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=2*this.outerWall+this.width*(this.pathWidth+this.wall)-this.wall,this.canvas.height=2*this.outerWall+this.height*(this.pathWidth+this.wall)-this.wall,this.ctx.fillStyle=this.wallColor,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.strokeStyle=this.pathColor,this.ctx.lineCap="square",this.ctx.lineWidth=this.pathWidth,this.ctx.beginPath();for(var t=0;t<2*this.height;t++){this.map[t]=[];for(var e=0;e<2*this.width;e++)this.map[t][e]=!1}this.map[2*this.y][2*this.x]=!0,this.route=[[this.x,this.y]],this.ctx.moveTo(this.x*(this.pathWidth+this.wall)+this.offset,this.y*(this.pathWidth+this.wall)+this.offset),this.generate()}},{key:"generate",value:function(){for(var t=0|this.route[this.route.length-1][0],e=0|this.route[this.route.length-1][1],i=[[1,0],[-1,0],[0,1],[0,-1]],n=[],a=0;a<i.length;a++)null!=this.map[2*(i[a][1]+e)]&&!1===this.map[2*(i[a][1]+e)][2*(i[a][0]+t)]&&n.push(i[a]);if(0===n.length)return this.route.pop(),void(this.route.length>0&&(this.ctx.moveTo(this.route[this.route.length-1][0]*(this.pathWidth+this.wall)+this.offset,this.route[this.route.length-1][1]*(this.pathWidth+this.wall)+this.offset),this.generate()));var h=n[this.seedRand()*n.length|0];this.route.push([h[0]+t,h[1]+e]),this.ctx.lineTo((h[0]+t)*(this.pathWidth+this.wall)+this.offset,(h[1]+e)*(this.pathWidth+this.wall)+this.offset),this.map[2*(h[1]+e)][2*(h[0]+t)]=!0,this.map[h[1]+2*e][h[0]+2*t]=!0,this.ctx.stroke(),this.route.length>0&&this.generate()}},{key:"getDataURL",value:function(){return this.canvas.toDataURL()}}])&&s(e.prototype,i),n&&s(e,n),t}(),u=i(128);function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.paramList=e,this.scene=null,this.renderer=null,this.camera=null,this.controls=null,this.mazeSphere=null,this.heightfieldShape=null,this.heightfieldBody=null,this.world=null,this.loader=new n.n}var e,i,r;return e=t,(i=[{key:"setupPhysics",value:function(t){this.world=new a.c,this.world.gravity.set(0,-9.8,0),this.heightfieldShape=new a.b(t,{elementSize:1}),this.heightfieldBody=new a.a({mass:0}),this.heightfieldBody.addShape(this.heightfieldShape),this.world.addBody(this.heightfieldBody)}},{key:"convertURIToImageData",value:function(t){return new Promise((function(e,i){if(null==t)return i();var n=document.createElement("canvas"),a=n.getContext("2d"),h=new Image;h.addEventListener("load",(function(){n.width=h.width,n.height=h.height,a.drawImage(h,0,0,n.width,n.height),e(a.getImageData(0,0,n.width,n.height))}),!1),h.src=t}))}},{key:"listToMatrix",value:function(t,e){var i,n,a=[];for(i=0,n=-1;i<t.length;i+=4)i%e==0&&(a[++n]=[]),a[n].push([t[i],t[i+1],t[i+2],t[i+3]]);return a}},{key:"hexToRgb",value:function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}},{key:"paramHandler",value:function(){var t=this,e=this.initMaze(this.paramList);this.hexToRgb(this.paramList.objColor),this.loadHeightMap(e,(function(e){t.mazeSphere.material=e}))}},{key:"initMaze",value:function(t){return new l(t).getDataURL()}},{key:"loadHeightMap",value:function(t,e){var i=this;this.convertURIToImageData(t).then((function(t){console.log(t),console.log(i.listToMatrix(t.data,t.width))})),this.loader.load(t,(function(t){t.wrapT=t.wrapS=n.h,t.mapping=n.o,t.repeat.set(4,4),console.log(t);var a=i.createMat({texture:t});"function"==typeof e&&e(a)}))}},{key:"createMat",value:function(t){for(var e=t.texture,i=this.hexToRgb(f.objColor),a=[],h=0;h<256;h++)a.push(new n.q(.5,.4,.3));var r={zTexture:{type:"t",value:e},zScale:{type:"f",value:1},zLut:{type:"v3v",value:a}};return new n.j({uniforms:r,vertexShader:"uniform sampler2D   zTexture;\n                            uniform float       zScale;\n                            uniform vec3        zLut[ 256 ];\n\n                            varying float vAmount;\n\n                            void main() {\n                                vec4 heightData = texture2D( zTexture, uv * ".concat(this.paramList.sectors,". );\n\n                                vAmount = heightData.r * 16.; \n\n                                // move the position along the normal\n                                vec3 newPosition = position + normal * zScale * vAmount;\n\n                                gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 0.5 );\n                            }"),fragmentShader:"uniform vec3 zLut[ 256 ];\n\n                            varying float vAmount;\n\n                            void main() {\n                                int index = int(vAmount) * 255;\n                                float brightness = 7.;\n                                vec3 vColor = vec3(vAmount/brightness, vAmount/brightness, vAmount/brightness);\n                                //gl_FragColor = vec4(zLut[32], 1.0);\n                                vec3 col2 = vec3 ((".concat(i.r,".0 / 255.0), (").concat(i.g,".0 / 255.0), (").concat(i.b,".0 / 255.0));\n                                gl_FragColor = vec4(mix(vColor,col2,0.5), 1.0);\n                            }"),flatshading:!0})}},{key:"init",value:function(){var t=this,e=this;this.renderer=new n.r({antialias:!0});var i=window.innerWidth,a=window.innerHeight;this.renderer.setSize(i,a),document.body.appendChild(this.renderer.domElement),this.scene=new n.i,this.camera=new n.f(45,i/a,1,1e4),this.camera.position.y=25,this.camera.position.z=-475,this.camera.lookAt(new n.q(0,0,0)),this.controls=new h.a(this.camera,this.renderer.domElement),this.controls.update();var r=new n.a(8421504);this.scene.add(r);var o=new n.b(12632256);o.position.set(5,20,12),this.scene.add(o),window.addEventListener("resize",(function(){t.onWindowResize()}),!1),this.dataURI=this.initMaze(this.paramList),this.gui=new u.a({width:650}),this.gui.add(this.paramList,"pathWidth").name("Width of the Maze Path").onChange((function(){e.paramHandler()})),this.gui.add(this.paramList,"wall").name("Width of the Walls between Paths").onChange((function(){e.paramHandler()})),this.gui.add(this.paramList,"sectors").name("Number of times maze is repeated").onChange((function(){e.paramHandler()})),this.gui.add(this.paramList,"outerWall").name("Width of the Outer most wall").onChange((function(){e.paramHandler()})),this.gui.add(this.paramList,"width").name("Number paths fitted horisontally").onChange((function(){e.paramHandler()})),this.gui.add(this.paramList,"height").name("Number paths fitted vertically").onChange((function(){e.paramHandler()})),this.gui.addColor(this.paramList,"wallColor").name("Heightmap Wall Color Differential").onChange((function(){e.paramHandler()})),this.gui.addColor(this.paramList,"pathColor").name("Heightmap Path Color Differential").onChange((function(){e.paramHandler()})),this.gui.addColor(this.paramList,"objColor").name("Sphere Base Color").onChange((function(){e.paramHandler()})),this.gui.add(this.paramList,"seed").name("Seed for the Random Number Generator").onChange((function(){e.paramHandler()})),this.loadHeightMap(this.dataURI,(function(e){var i=new n.k(50,100,100);t.mazeSphere=new n.e(i,e),t.mazeSphere.rotation.x=-Math.PI/2,t.mazeSphere.position.y=0,console.log(t.mazeSphere),t.scene.add(t.mazeSphere)})),this.animate()}},{key:"onWindowResize",value:function(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}},{key:"animate",value:function(){var t=this;requestAnimationFrame((function(){t.animate()})),this.renderer.render(this.scene,this.camera)}},{key:"heightmapPhysics",value:function(t){for(var e=[],i=0;i<15;i++){e.push([]);for(var n=0;n<15;n++){var a="";0!==i&&14!==i&&0!==n&&14!==n||(a=3),e[i].push(a)}}}}])&&d(e.prototype,i),r&&d(e,r),t}(),f=new function(){this.pathWidth=25,this.wall=25,this.sectors=2,this.width=15,this.height=15,this.wallColor="#ffffff",this.pathColor="#000000",this.objColor="#460a50",this.outerWall=15,this.seed="1"};new c(f).init()}});